declare @comps TABLE(ComponentTypeID INT, OID VARCHAR(50))

INSERT INTO @comps(ComponentTypeID, OID) VALUES(136,'Classification')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(137,'UsageClassification')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(138,'StandardNameCode')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(139,'DrugNameKana')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(140,'PreferredNameKana')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(141,'Manufacturer')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(142,'DosageForm')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(143,'DrugCodeClass1')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(144,'MaintainFlagJpn')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(145,'MaintainDateJpn')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(146,'DrugCodeClass2')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(147,'JANFlag')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(148,'INNFlag')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(149,'Reserve')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(150,'MaintainDateEng')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(151,'MaintainFlagEng')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(152,'EnglishName')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(154,'DRUGRECORDNUMBER')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(155,'SEQUENCENUMBER1')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(156,'SEQUENCENUMBER2')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(157,'CHECKDIGIT')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(158,'SOURCEYEAR')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(159,'SOURCE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(160,'SOURCECOUNTRY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(161,'DESIGNATION')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(162,'COMPANY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(163,'COMPANYCOUNTRY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(164,'NUMBEROFINGREDIENTS')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(165,'SALTESTERCODE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(166,'YEARQUARTER')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(167,'CASNUMBER')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(168,'LANGUAGECODE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(169,'SUBSTANCENAME')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(171,'DRUGRECORDNUMBER')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(172,'SEQUENCENUMBER1')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(173,'SEQUENCENUMBER2')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(174,'CHECKDIGIT')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(175,'SOURCEYEAR')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(176,'SOURCE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(177,'SOURCECOUNTRY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(178,'DESIGNATION')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(179,'COMPANY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(180,'COMPANYCOUNTRY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(181,'NUMBEROFINGREDIENTS')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(182,'SALTESTERCODE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(183,'YEARQUARTER')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(184,'CASNUMBER')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(185,'LANGUAGECODE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(186,'SUBSTANCENAME')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(188,'DRUGRECORDNUMBER')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(189,'SEQUENCENUMBER1')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(190,'SEQUENCENUMBER2')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(191,'CHECKDIGIT')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(192,'SOURCEYEAR')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(193,'SOURCE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(194,'SOURCECOUNTRY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(195,'DESIGNATION')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(196,'COMPANY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(197,'COMPANYCOUNTRY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(198,'NUMBEROFINGREDIENTS')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(199,'SALTESTERCODE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(200,'YEARQUARTER')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(201,'CASNUMBER')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(202,'LANGUAGECODE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(203,'SUBSTANCENAME')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(205,'DRUGRECORDNUMBER')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(206,'SEQUENCENUMBER1')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(207,'SEQUENCENUMBER2')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(208,'CHECKDIGIT')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(209,'SOURCEYEAR')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(210,'SOURCE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(211,'SOURCECOUNTRY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(212,'DESIGNATION')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(213,'COMPANY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(214,'COMPANYCOUNTRY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(215,'NUMBEROFINGREDIENTS')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(216,'SALTESTERCODE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(217,'YEARQUARTER')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(218,'CASNUMBER')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(219,'LANGUAGECODE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(220,'SUBSTANCENAME')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(222,'DRUGRECORDNUMBER')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(223,'SEQUENCENUMBER1')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(224,'SEQUENCENUMBER2')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(225,'SEQUENCENUMBER3')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(226,'SEQUENCENUMBER4')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(227,'GENERIC')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(228,'NAMESPECIFIER')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(229,'MARKETINGAUTHORIZATIONNUMBER')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(230,'MARKETINGAUTHORIZATIONDATE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(231,'MARKETINGAUTHORIZATIONWITHDRAWALDATE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(232,'COUNTRY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(233,'COMPANY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(234,'COMPANYCOUNTRY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(235,'MARKETINGAUTHORIZATIONHOLDER')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(236,'MARKETINGAUTHORIZATIONHOLDERCOUNTRY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(237,'SOURCEYEAR')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(238,'SOURCE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(239,'SOURCECOUNTRY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(240,'PRODUCTTYPE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(241,'PRODUCTGROUP')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(242,'PRODUCTGROUPDATERECORDED')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(243,'CREATEDATE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(244,'DATECHANGED')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(245,'INGREDIENTCREATEDATE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(246,'QUANTITY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(247,'QUANTITY2')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(248,'UNIT')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(249,'PHARMACEUTICALFORM')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(250,'ROUTEOFADMINISTRATION')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(251,'NUMBEROFINGREDIENTS')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(252,'PHARMACEUTICALFORMCREATEDATE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(253,'SUBSTANCE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(254,'CASNUMBER')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(255,'LANGUAGECODE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(257,'DRUGRECORDNUMBER')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(258,'SEQUENCENUMBER1')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(259,'SEQUENCENUMBER2')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(260,'SEQUENCENUMBER3')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(261,'SEQUENCENUMBER4')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(262,'GENERIC')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(263,'NAMESPECIFIER')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(264,'MARKETINGAUTHORIZATIONNUMBER')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(265,'MARKETINGAUTHORIZATIONDATE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(266,'MARKETINGAUTHORIZATIONWITHDRAWALDATE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(267,'COUNTRY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(268,'COMPANY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(269,'COMPANYCOUNTRY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(270,'MARKETINGAUTHORIZATIONHOLDER')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(271,'MARKETINGAUTHORIZATIONHOLDERCOUNTRY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(272,'SOURCEYEAR')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(273,'SOURCE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(274,'SOURCECOUNTRY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(275,'PRODUCTTYPE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(276,'PRODUCTGROUP')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(277,'PRODUCTGROUPDATERECORDED')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(278,'CREATEDATE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(279,'DATECHANGED')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(280,'INGREDIENTCREATEDATE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(281,'QUANTITY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(282,'QUANTITY2')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(283,'UNIT')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(284,'PHARMACEUTICALFORM')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(285,'ROUTEOFADMINISTRATION')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(286,'NUMBEROFINGREDIENTS')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(287,'PHARMACEUTICALFORMCREATEDATE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(288,'SUBSTANCE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(289,'CASNUMBER')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(290,'LANGUAGECODE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(291,'Classification')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(292,'UsageClassification')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(293,'StandardNameCode')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(294,'DrugNameKana')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(295,'PreferredNameKana')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(296,'Manufacturer')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(297,'DosageForm')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(298,'DrugCodeClass1')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(299,'MaintainFlagJpn')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(300,'MaintainDateJpn')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(301,'DrugCodeClass2')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(302,'JANFlag')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(303,'INNFlag')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(304,'Reserve')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(305,'MaintainDateEng')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(306,'MaintainFlagEng')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(307,'EnglishName')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(308,'DRUGRECORDNUMBER')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(309,'SEQUENCENUMBER1')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(310,'SEQUENCENUMBER2')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(311,'SEQUENCENUMBER3')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(312,'SEQUENCENUMBER4')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(313,'GENERIC')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(314,'NAMESPECIFIER')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(315,'MARKETINGAUTHORIZATIONNUMBER')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(316,'MARKETINGAUTHORIZATIONDATE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(317,'MARKETINGAUTHORIZATIONWITHDRAWALDATE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(318,'COUNTRY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(319,'COMPANY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(320,'COMPANYCOUNTRY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(321,'MARKETINGAUTHORIZATIONHOLDER')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(322,'MARKETINGAUTHORIZATIONHOLDERCOUNTRY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(323,'SOURCEYEAR')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(324,'SOURCE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(325,'SOURCECOUNTRY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(326,'PRODUCTTYPE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(327,'PRODUCTGROUP')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(328,'PRODUCTGROUPDATERECORDED')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(329,'CREATEDATE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(330,'DATECHANGED')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(331,'INGREDIENTCREATEDATE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(332,'QUANTITY')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(333,'QUANTITY2')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(334,'UNIT')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(335,'PHARMACEUTICALFORM')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(336,'ROUTEOFADMINISTRATION')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(337,'NUMBEROFINGREDIENTS')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(338,'PHARMACEUTICALFORMCREATEDATE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(339,'SUBSTANCE')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(340,'CASNUMBER')
INSERT INTO @comps(ComponentTypeID, OID) VALUES(341,'LANGUAGECODE')

BEGIN TRY
BEGIN TRANSACTION

	INSERT INTO SupplementFieldKeys(KeyField)
	SELECT DISTINCT(C.OID)
	FROM @comps C
		LEFT JOIN SupplementFieldKeys SFK
			ON SFK.KeyField = C.OID
	WHERE SFK.SupplementFieldKeyId IS NULL

	UPDATE CEGC
	SET CEGC.ComponentTypeID = SFK.SupplementFieldKeyId
	FROM CodingElementGroupComponents CEGC
		JOIN @comps C
			ON C.ComponentTypeID = CEGC.ComponentTypeID
		JOIN SupplementFieldKeys SFK
			ON SFK.KeyField = C.OID
	WHERE CEGC.IsSupplement = 0

	EXEC sp_rename
		@objname = 'CodingElementGroupComponents.ComponentTypeID',
		@newname = 'SupplementFieldKeyId',
		@objtype = 'COLUMN'

	INSERT INTO CodingSourceTermSupplementals
	(CodingSourceTermID, SearchOperator, SupplementalValue, SupplementTermKey, Ordinal, SegmentId, IsComponent)
	SELECT 
		CodingSourceTermID, SearchOperator, ComponentValue, ComponentName, Ordinal, SegmentId, 1
	FROM CodingSourceTermComponents

	IF (EXISTS (SELECT NULL FROM INFORMATION_SCHEMA.TABLES
		WHERE TABLE_NAME = 'CodingSourceTermComponents'))
		DROP TABLE CodingSourceTermComponents

	COMMIT TRANSACTION

END TRY
BEGIN CATCH
	ROLLBACK TRANSACTION

	DECLARE @errorString NVARCHAR(1000) = N'ERROR Component to SupplementField transaction Error Message - ' + ERROR_MESSAGE()
	PRINT @errorString
	RAISERROR(@errorString, 16, 1)
END CATCH




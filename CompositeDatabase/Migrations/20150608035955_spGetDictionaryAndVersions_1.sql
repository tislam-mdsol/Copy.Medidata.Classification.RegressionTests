IF object_id('spGetDictionaryAndVersions') IS NOT NULL
	DROP PROCEDURE dbo.spGetDictionaryAndVersions
GO

CREATE PROCEDURE [dbo].spGetDictionaryAndVersions
AS

BEGIN

	DECLARE @t TABLE(
	versionId INT PRIMARY KEY, 
	dictionaryid INT, 
	dictionaryOid VARCHAR(50), 
	versionOid VARCHAR(50))

-- generated from
--DECLARE @dMapping TABLE(OldOID VARCHAR(50), NewOID VARCHAR(50))

--INSERT INTO @dMapping (OldOID, NewOID)
--VALUES
--- ('MedDRA','MedDRA'),
--	('AZDD','AZDD'),
--	('WhoDrugDDB2','WHODrug-DD-B2'),
--	('WhoDrugDDEB2','WHODrug-DDE-B2'),
--	('HD_DDE_B2','WHODrug-DDE_HD-B2'),
--	('WhoDrugDDC','WHODrug-DD-C'),
--	('WHODrug_DDE_C','WHODrug-DDE-C'),
--	('JDrug','JDrug'),
--	('WhoDrugHDDDEC','WHODrug-DDE_HD-C'),
--	('MedDRAMedHistory','MedDRAMedHistory') -- to be removed

--SELECT '(',
--	v.DictionaryVersionId, ',',
--	d.MedicalDictionaryId,  ',',
--	''''+d.OID+'''',  ',',
--	''''+v.OID+'''',  '),'

--FROM MedicalDictionary d
--	JOIN MedicalDictionaryVersion v
--		ON d.MedicalDictionaryId = v.MedicalDictionaryId
--	JOIN @dMapping m
--		ON d.OID = m.OldOID
--WHERE d.MedicalDictionaryId > 12
--ORDER BY d.MedicalDictionaryId, v.Ordinal


insert into @t(versionId, dictionaryid, dictionaryOid, versionOid)
VALUES
(	166	,	14	,	'AZDD'	,	'6.1'	),
(	167	,	14	,	'AZDD'	,	'6.2'	),
(	168	,	14	,	'AZDD'	,	'7.2'	),
(	169	,	14	,	'AZDD'	,	'7.3'	),
(	170	,	14	,	'AZDD'	,	'8.1'	),
(	171	,	14	,	'AZDD'	,	'8.3'	),
(	172	,	14	,	'AZDD'	,	'9.1'	),
(	173	,	14	,	'AZDD'	,	'9.2'	),
(	174	,	14	,	'AZDD'	,	'10.1'	),
(	175	,	14	,	'AZDD'	,	'10.2'	),
(	176	,	14	,	'AZDD'	,	'11.1'	),
(	177	,	14	,	'AZDD'	,	'11.2'	),
(	178	,	14	,	'AZDD'	,	'12.1'	),
(	315	,	14	,	'AZDD'	,	'12.2'	),
(	362	,	14	,	'AZDD'	,	'13.1'	),
(	382	,	14	,	'AZDD'	,	'13.2'	),
(	421	,	14	,	'AZDD'	,	'14.1'	),
(	442	,	14	,	'AZDD'	,	'14.2'	),
(	456	,	14	,	'AZDD'	,	'15.1'	),
(	180	,	16	,	'WhoDrugDDEB2'	,	'200603'	),
(	181	,	16	,	'WhoDrugDDEB2'	,	'200606'	),
(	182	,	16	,	'WhoDrugDDEB2'	,	'200609'	),
(	183	,	16	,	'WhoDrugDDEB2'	,	'200612'	),
(	184	,	16	,	'WhoDrugDDEB2'	,	'200703'	),
(	185	,	16	,	'WhoDrugDDEB2'	,	'200706'	),
(	186	,	16	,	'WhoDrugDDEB2'	,	'200709'	),
(	187	,	16	,	'WhoDrugDDEB2'	,	'200712'	),
(	188	,	16	,	'WhoDrugDDEB2'	,	'200803'	),
(	189	,	16	,	'WhoDrugDDEB2'	,	'200806'	),
(	190	,	16	,	'WhoDrugDDEB2'	,	'200809'	),
(	191	,	16	,	'WhoDrugDDEB2'	,	'200812'	),
(	192	,	16	,	'WhoDrugDDEB2'	,	'200903'	),
(	193	,	16	,	'WhoDrugDDEB2'	,	'200906'	),
(	194	,	16	,	'WhoDrugDDEB2'	,	'200909'	),
(	195	,	16	,	'WhoDrugDDEB2'	,	'200912'	),
(	196	,	16	,	'WhoDrugDDEB2'	,	'201003'	),
(	197	,	16	,	'WhoDrugDDEB2'	,	'201006'	),
(	198	,	16	,	'WhoDrugDDEB2'	,	'201009'	),
(	199	,	16	,	'WhoDrugDDEB2'	,	'201012'	),
(	200	,	16	,	'WhoDrugDDEB2'	,	'201103'	),
(	201	,	16	,	'WhoDrugDDEB2'	,	'201106'	),
(	202	,	16	,	'WhoDrugDDEB2'	,	'201109'	),
(	203	,	16	,	'WhoDrugDDEB2'	,	'201112'	),
(	204	,	16	,	'WhoDrugDDEB2'	,	'201203'	),
(	313	,	16	,	'WhoDrugDDEB2'	,	'201206'	),
(	318	,	16	,	'WhoDrugDDEB2'	,	'201209'	),
(	323	,	16	,	'WhoDrugDDEB2'	,	'201212'	),
(	364	,	16	,	'WhoDrugDDEB2'	,	'201303'	),
(	371	,	16	,	'WhoDrugDDEB2'	,	'201306'	),
(	381	,	16	,	'WhoDrugDDEB2'	,	'201309'	),
(	386	,	16	,	'WhoDrugDDEB2'	,	'201312'	),
(	428	,	16	,	'WhoDrugDDEB2'	,	'201403'	),
(	430	,	16	,	'WhoDrugDDEB2'	,	'201406'	),
(	441	,	16	,	'WhoDrugDDEB2'	,	'201409'	),
(	446	,	16	,	'WhoDrugDDEB2'	,	'201412'	),
(	454	,	16	,	'WhoDrugDDEB2'	,	'201503'	),
(	468	,	16	,	'WhoDrugDDEB2'	,	'201506'	),
(	206	,	18	,	'WhoDrugDDB2'	,	'200603'	),
(	207	,	18	,	'WhoDrugDDB2'	,	'200606'	),
(	208	,	18	,	'WhoDrugDDB2'	,	'200609'	),
(	209	,	18	,	'WhoDrugDDB2'	,	'200612'	),
(	210	,	18	,	'WhoDrugDDB2'	,	'200703'	),
(	211	,	18	,	'WhoDrugDDB2'	,	'200706'	),
(	212	,	18	,	'WhoDrugDDB2'	,	'200709'	),
(	213	,	18	,	'WhoDrugDDB2'	,	'200712'	),
(	214	,	18	,	'WhoDrugDDB2'	,	'200803'	),
(	215	,	18	,	'WhoDrugDDB2'	,	'200806'	),
(	216	,	18	,	'WhoDrugDDB2'	,	'200809'	),
(	217	,	18	,	'WhoDrugDDB2'	,	'200812'	),
(	218	,	18	,	'WhoDrugDDB2'	,	'200903'	),
(	219	,	18	,	'WhoDrugDDB2'	,	'200906'	),
(	220	,	18	,	'WhoDrugDDB2'	,	'200909'	),
(	221	,	18	,	'WhoDrugDDB2'	,	'200912'	),
(	222	,	18	,	'WhoDrugDDB2'	,	'201003'	),
(	223	,	18	,	'WhoDrugDDB2'	,	'201006'	),
(	224	,	18	,	'WhoDrugDDB2'	,	'201009'	),
(	225	,	18	,	'WhoDrugDDB2'	,	'201012'	),
(	226	,	18	,	'WhoDrugDDB2'	,	'201103'	),
(	227	,	18	,	'WhoDrugDDB2'	,	'201106'	),
(	228	,	18	,	'WhoDrugDDB2'	,	'201109'	),
(	229	,	18	,	'WhoDrugDDB2'	,	'201112'	),
(	230	,	18	,	'WhoDrugDDB2'	,	'201203'	),
(	310	,	18	,	'WhoDrugDDB2'	,	'201206'	),
(	320	,	18	,	'WhoDrugDDB2'	,	'201209'	),
(	324	,	18	,	'WhoDrugDDB2'	,	'201212'	),
(	365	,	18	,	'WhoDrugDDB2'	,	'201303'	),
(	370	,	18	,	'WhoDrugDDB2'	,	'201306'	),
(	380	,	18	,	'WhoDrugDDB2'	,	'201309'	),
(	387	,	18	,	'WhoDrugDDB2'	,	'201312'	),
(	426	,	18	,	'WhoDrugDDB2'	,	'201403'	),
(	431	,	18	,	'WhoDrugDDB2'	,	'201406'	),
(	444	,	18	,	'WhoDrugDDB2'	,	'201409'	),
(	445	,	18	,	'WhoDrugDDB2'	,	'201412'	),
(	457	,	18	,	'WhoDrugDDB2'	,	'201503'	),
(	465	,	18	,	'WhoDrugDDB2'	,	'201506'	),
(	232	,	20	,	'HD_DDE_B2'	,	'200603'	),
(	233	,	20	,	'HD_DDE_B2'	,	'200606'	),
(	234	,	20	,	'HD_DDE_B2'	,	'200609'	),
(	235	,	20	,	'HD_DDE_B2'	,	'200612'	),
(	236	,	20	,	'HD_DDE_B2'	,	'200703'	),
(	237	,	20	,	'HD_DDE_B2'	,	'200706'	),
(	238	,	20	,	'HD_DDE_B2'	,	'200709'	),
(	239	,	20	,	'HD_DDE_B2'	,	'200712'	),
(	240	,	20	,	'HD_DDE_B2'	,	'200803'	),
(	241	,	20	,	'HD_DDE_B2'	,	'200806'	),
(	242	,	20	,	'HD_DDE_B2'	,	'200809'	),
(	243	,	20	,	'HD_DDE_B2'	,	'200812'	),
(	244	,	20	,	'HD_DDE_B2'	,	'200903'	),
(	245	,	20	,	'HD_DDE_B2'	,	'200906'	),
(	246	,	20	,	'HD_DDE_B2'	,	'200909'	),
(	247	,	20	,	'HD_DDE_B2'	,	'200912'	),
(	248	,	20	,	'HD_DDE_B2'	,	'201003'	),
(	249	,	20	,	'HD_DDE_B2'	,	'201006'	),
(	250	,	20	,	'HD_DDE_B2'	,	'201009'	),
(	251	,	20	,	'HD_DDE_B2'	,	'201012'	),
(	252	,	20	,	'HD_DDE_B2'	,	'201103'	),
(	253	,	20	,	'HD_DDE_B2'	,	'201106'	),
(	254	,	20	,	'HD_DDE_B2'	,	'201109'	),
(	255	,	20	,	'HD_DDE_B2'	,	'201112'	),
(	256	,	20	,	'HD_DDE_B2'	,	'201203'	),
(	311	,	20	,	'HD_DDE_B2'	,	'201206'	),
(	321	,	20	,	'HD_DDE_B2'	,	'201209'	),
(	326	,	20	,	'HD_DDE_B2'	,	'201212'	),
(	366	,	20	,	'HD_DDE_B2'	,	'201303'	),
(	372	,	20	,	'HD_DDE_B2'	,	'201306'	),
(	379	,	20	,	'HD_DDE_B2'	,	'201309'	),
(	384	,	20	,	'HD_DDE_B2'	,	'201312'	),
(	422	,	20	,	'HD_DDE_B2'	,	'201403'	),
(	432	,	20	,	'HD_DDE_B2'	,	'201406'	),
(	439	,	20	,	'HD_DDE_B2'	,	'201409'	),
(	449	,	20	,	'HD_DDE_B2'	,	'201412'	),
(	455	,	20	,	'HD_DDE_B2'	,	'201503'	),
(	463	,	20	,	'HD_DDE_B2'	,	'201506'	),
(	258	,	22	,	'WhoDrugDDC'	,	'200603'	),
(	259	,	22	,	'WhoDrugDDC'	,	'200606'	),
(	260	,	22	,	'WhoDrugDDC'	,	'200609'	),
(	261	,	22	,	'WhoDrugDDC'	,	'200612'	),
(	262	,	22	,	'WhoDrugDDC'	,	'200703'	),
(	263	,	22	,	'WhoDrugDDC'	,	'200706'	),
(	264	,	22	,	'WhoDrugDDC'	,	'200709'	),
(	265	,	22	,	'WhoDrugDDC'	,	'200712'	),
(	266	,	22	,	'WhoDrugDDC'	,	'200803'	),
(	267	,	22	,	'WhoDrugDDC'	,	'200806'	),
(	268	,	22	,	'WhoDrugDDC'	,	'200809'	),
(	269	,	22	,	'WhoDrugDDC'	,	'200812'	),
(	270	,	22	,	'WhoDrugDDC'	,	'200903'	),
(	271	,	22	,	'WhoDrugDDC'	,	'200906'	),
(	272	,	22	,	'WhoDrugDDC'	,	'200909'	),
(	273	,	22	,	'WhoDrugDDC'	,	'200912'	),
(	274	,	22	,	'WhoDrugDDC'	,	'201003'	),
(	275	,	22	,	'WhoDrugDDC'	,	'201006'	),
(	276	,	22	,	'WhoDrugDDC'	,	'201009'	),
(	277	,	22	,	'WhoDrugDDC'	,	'201012'	),
(	278	,	22	,	'WhoDrugDDC'	,	'201103'	),
(	279	,	22	,	'WhoDrugDDC'	,	'201106'	),
(	280	,	22	,	'WhoDrugDDC'	,	'201109'	),
(	281	,	22	,	'WhoDrugDDC'	,	'201112'	),
(	282	,	22	,	'WhoDrugDDC'	,	'201203'	),
(	309	,	22	,	'WhoDrugDDC'	,	'201206'	),
(	319	,	22	,	'WhoDrugDDC'	,	'201209'	),
(	325	,	22	,	'WhoDrugDDC'	,	'201212'	),
(	368	,	22	,	'WhoDrugDDC'	,	'201303'	),
(	374	,	22	,	'WhoDrugDDC'	,	'201306'	),
(	378	,	22	,	'WhoDrugDDC'	,	'201309'	),
(	385	,	22	,	'WhoDrugDDC'	,	'201312'	),
(	427	,	22	,	'WhoDrugDDC'	,	'201403'	),
(	433	,	22	,	'WhoDrugDDC'	,	'201406'	),
(	443	,	22	,	'WhoDrugDDC'	,	'201409'	),
(	447	,	22	,	'WhoDrugDDC'	,	'201412'	),
(	459	,	22	,	'WhoDrugDDC'	,	'201503'	),
(	467	,	22	,	'WhoDrugDDC'	,	'201506'	),
(	284	,	24	,	'WHODrug_DDE_C'	,	'200603'	),
(	285	,	24	,	'WHODrug_DDE_C'	,	'200606'	),
(	286	,	24	,	'WHODrug_DDE_C'	,	'200609'	),
(	287	,	24	,	'WHODrug_DDE_C'	,	'200612'	),
(	288	,	24	,	'WHODrug_DDE_C'	,	'200703'	),
(	289	,	24	,	'WHODrug_DDE_C'	,	'200706'	),
(	290	,	24	,	'WHODrug_DDE_C'	,	'200709'	),
(	291	,	24	,	'WHODrug_DDE_C'	,	'200712'	),
(	292	,	24	,	'WHODrug_DDE_C'	,	'200803'	),
(	293	,	24	,	'WHODrug_DDE_C'	,	'200806'	),
(	294	,	24	,	'WHODrug_DDE_C'	,	'200809'	),
(	295	,	24	,	'WHODrug_DDE_C'	,	'200812'	),
(	296	,	24	,	'WHODrug_DDE_C'	,	'200903'	),
(	297	,	24	,	'WHODrug_DDE_C'	,	'200906'	),
(	298	,	24	,	'WHODrug_DDE_C'	,	'200909'	),
(	299	,	24	,	'WHODrug_DDE_C'	,	'200912'	),
(	300	,	24	,	'WHODrug_DDE_C'	,	'201003'	),
(	301	,	24	,	'WHODrug_DDE_C'	,	'201006'	),
(	302	,	24	,	'WHODrug_DDE_C'	,	'201009'	),
(	303	,	24	,	'WHODrug_DDE_C'	,	'201012'	),
(	304	,	24	,	'WHODrug_DDE_C'	,	'201103'	),
(	305	,	24	,	'WHODrug_DDE_C'	,	'201106'	),
(	306	,	24	,	'WHODrug_DDE_C'	,	'201109'	),
(	307	,	24	,	'WHODrug_DDE_C'	,	'201112'	),
(	308	,	24	,	'WHODrug_DDE_C'	,	'201203'	),
(	312	,	24	,	'WHODrug_DDE_C'	,	'201206'	),
(	322	,	24	,	'WHODrug_DDE_C'	,	'201209'	),
(	327	,	24	,	'WHODrug_DDE_C'	,	'201212'	),
(	367	,	24	,	'WHODrug_DDE_C'	,	'201303'	),
(	373	,	24	,	'WHODrug_DDE_C'	,	'201306'	),
(	377	,	24	,	'WHODrug_DDE_C'	,	'201309'	),
(	388	,	24	,	'WHODrug_DDE_C'	,	'201312'	),
(	425	,	24	,	'WHODrug_DDE_C'	,	'201403'	),
(	434	,	24	,	'WHODrug_DDE_C'	,	'201406'	),
(	440	,	24	,	'WHODrug_DDE_C'	,	'201409'	),
(	448	,	24	,	'WHODrug_DDE_C'	,	'201412'	),
(	458	,	24	,	'WHODrug_DDE_C'	,	'201503'	),
(	464	,	24	,	'WHODrug_DDE_C'	,	'201506'	),
(	329	,	26	,	'MedDRA'	,	'9.0'	),
(	330	,	26	,	'MedDRA'	,	'9.1'	),
(	331	,	26	,	'MedDRA'	,	'10.0'	),
(	332	,	26	,	'MedDRA'	,	'10.1'	),
(	333	,	26	,	'MedDRA'	,	'11.0'	),
(	334	,	26	,	'MedDRA'	,	'11.1'	),
(	335	,	26	,	'MedDRA'	,	'12.0'	),
(	336	,	26	,	'MedDRA'	,	'12.1'	),
(	337	,	26	,	'MedDRA'	,	'13.0'	),
(	338	,	26	,	'MedDRA'	,	'13.1'	),
(	339	,	26	,	'MedDRA'	,	'14.0'	),
(	340	,	26	,	'MedDRA'	,	'14.1'	),
(	341	,	26	,	'MedDRA'	,	'15.0'	),
(	342	,	26	,	'MedDRA'	,	'15.1'	),
(	360	,	26	,	'MedDRA'	,	'16.0'	),
(	375	,	26	,	'MedDRA'	,	'16.1'	),
(	423	,	26	,	'MedDRA'	,	'17.0'	),
(	437	,	26	,	'MedDRA'	,	'17.1'	),
(	453	,	26	,	'MedDRA'	,	'18.0'	),
(	343	,	27	,	'JDrug'	,	'2011H1'	),
(	344	,	27	,	'JDrug'	,	'2011H2'	),
(	345	,	27	,	'JDrug'	,	'2012H1'	),
(	363	,	27	,	'JDrug'	,	'2012H2'	),
(	369	,	27	,	'JDrug'	,	'2013H1'	),
(	383	,	27	,	'JDrug'	,	'2013H2'	),
(	436	,	27	,	'JDrug'	,	'2014H1'	),
(	450	,	27	,	'JDrug'	,	'2014H2'	),
(	462	,	27	,	'JDrug'	,	'2015H1'	),
(	346	,	28	,	'MedDRAMedHistory'	,	'9.0'	),
(	347	,	28	,	'MedDRAMedHistory'	,	'9.1'	),
(	348	,	28	,	'MedDRAMedHistory'	,	'10.0'	),
(	349	,	28	,	'MedDRAMedHistory'	,	'10.1'	),
(	350	,	28	,	'MedDRAMedHistory'	,	'11.0'	),
(	351	,	28	,	'MedDRAMedHistory'	,	'11.1'	),
(	352	,	28	,	'MedDRAMedHistory'	,	'12.0'	),
(	353	,	28	,	'MedDRAMedHistory'	,	'12.1'	),
(	354	,	28	,	'MedDRAMedHistory'	,	'13.0'	),
(	355	,	28	,	'MedDRAMedHistory'	,	'13.1'	),
(	356	,	28	,	'MedDRAMedHistory'	,	'14.0'	),
(	357	,	28	,	'MedDRAMedHistory'	,	'14.1'	),
(	358	,	28	,	'MedDRAMedHistory'	,	'15.0'	),
(	359	,	28	,	'MedDRAMedHistory'	,	'15.1'	),
(	361	,	28	,	'MedDRAMedHistory'	,	'16.0'	),
(	376	,	28	,	'MedDRAMedHistory'	,	'16.1'	),
(	424	,	28	,	'MedDRAMedHistory'	,	'17.0'	),
(	438	,	28	,	'MedDRAMedHistory'	,	'17.1'	),
(	461	,	28	,	'MedDRAMedHistory'	,	'18.0'	),
(	389	,	29	,	'WhoDrugHDDDEC'	,	'200603'	),
(	390	,	29	,	'WhoDrugHDDDEC'	,	'200606'	),
(	391	,	29	,	'WhoDrugHDDDEC'	,	'200609'	),
(	392	,	29	,	'WhoDrugHDDDEC'	,	'200612'	),
(	393	,	29	,	'WhoDrugHDDDEC'	,	'200703'	),
(	394	,	29	,	'WhoDrugHDDDEC'	,	'200706'	),
(	395	,	29	,	'WhoDrugHDDDEC'	,	'200709'	),
(	396	,	29	,	'WhoDrugHDDDEC'	,	'200712'	),
(	397	,	29	,	'WhoDrugHDDDEC'	,	'200803'	),
(	398	,	29	,	'WhoDrugHDDDEC'	,	'200806'	),
(	399	,	29	,	'WhoDrugHDDDEC'	,	'200809'	),
(	400	,	29	,	'WhoDrugHDDDEC'	,	'200812'	),
(	401	,	29	,	'WhoDrugHDDDEC'	,	'200903'	),
(	402	,	29	,	'WhoDrugHDDDEC'	,	'200906'	),
(	403	,	29	,	'WhoDrugHDDDEC'	,	'200909'	),
(	404	,	29	,	'WhoDrugHDDDEC'	,	'200912'	),
(	405	,	29	,	'WhoDrugHDDDEC'	,	'201003'	),
(	406	,	29	,	'WhoDrugHDDDEC'	,	'201006'	),
(	407	,	29	,	'WhoDrugHDDDEC'	,	'201009'	),
(	408	,	29	,	'WhoDrugHDDDEC'	,	'201012'	),
(	409	,	29	,	'WhoDrugHDDDEC'	,	'201103'	),
(	410	,	29	,	'WhoDrugHDDDEC'	,	'201106'	),
(	411	,	29	,	'WhoDrugHDDDEC'	,	'201109'	),
(	412	,	29	,	'WhoDrugHDDDEC'	,	'201112'	),
(	413	,	29	,	'WhoDrugHDDDEC'	,	'201203'	),
(	414	,	29	,	'WhoDrugHDDDEC'	,	'201206'	),
(	415	,	29	,	'WhoDrugHDDDEC'	,	'201209'	),
(	416	,	29	,	'WhoDrugHDDDEC'	,	'201212'	),
(	417	,	29	,	'WhoDrugHDDDEC'	,	'201303'	),
(	418	,	29	,	'WhoDrugHDDDEC'	,	'201306'	),
(	419	,	29	,	'WhoDrugHDDDEC'	,	'201309'	),
(	420	,	29	,	'WhoDrugHDDDEC'	,	'201312'	),
(	429	,	29	,	'WhoDrugHDDDEC'	,	'201403'	),
(	435	,	29	,	'WhoDrugHDDDEC'	,	'201406'	),
(	451	,	29	,	'WhoDrugHDDDEC'	,	'201409'	),
(	452	,	29	,	'WhoDrugHDDDEC'	,	'201412'	),
(	460	,	29	,	'WhoDrugHDDDEC'	,	'201503'	),
(	466	,	29	,	'WhoDrugHDDDEC'	,	'201506'	)

	SELECT *
	FROM @t

END